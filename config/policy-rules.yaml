- name: "allow_websocket_fix_messages"
  match_pattern:
    msg_type: "BINARY"  # WebSocket binary frames
    source_ip: null
    min_length: 10
    max_length: 4096
    content_pattern: ".*35=D.*"  # Look for FIX New Order Single (D) in content
  action: !Allow

- name: "allow_websocket_text_messages"
  match_pattern:
    msg_type: "TEXT"  # WebSocket text frames
    source_ip: null
    min_length: 10
    max_length: 4096
    content_pattern: ".*35=D.*"  # Look for FIX New Order Single (D) in content
  action: !Allow

- name: "rate_limit_protection"
  match_pattern:
    msg_type: null
    source_ip: null
    min_length: null
    max_length: null
  action: !RateLimit 100

- name: "deny_large_messages"
  match_pattern:
    msg_type: null
    source_ip: null
    min_length: 5000
    max_length: null
  action: !Deny